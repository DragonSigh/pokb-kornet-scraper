# ПОКБ - Показатель 22 - Анализ работы кабинетов льготного лекарственного обеспечения

## Проблема

На основании приказа Министерства здравоохранения Московской области №107 «Об утверждении перечня показателей и критериев комплексного рейтинга медицинских организаций государственной системы здравоохранения Московской области» введён комплексный рейтинг подведомственных учреждений здравоохранения по перечню показателей и критериев.

Одним из показателей является п. 22 - РАБОТА КАБИНЕТОВ ЛЬГОТНОГО ЛЕКАРСТВЕННОГО ОБЕСПЕЧЕНИЯ, который расссчитывается как количество рецептов, выписанных в кабинетах выписки льготных препаратов по сравнению с общим количествем выписанных препаратов врачами в амбулатории совершеннолетним пациентам и результат оценивается по шкале: до 40% - 0 баллов, 40-60% - 1 балл, 60-70% - 3 балла и более  70% - 5 баллов.

Информация для расчётов берётся из отчётов по учреждению в целом и не учитывает его подразделения. Таким образом невозможно выявить локальные места, где наблюдаются проблемы с оформлением рецептов в кабинетах выписки льготных препаратов.

## Цель

Требуется предоставить информацию по параметрам расчёта показателя 22 в рамках одного учреждения здравоохранения, а именно: о рецептах, выписанных в кабинетах выписки льготных препаратов и обо всех рецептах, выписанных врачами препаратов за определенный период. Таким образом у руководителей подразделений и врачей будет информация о текущем положении и возможность внести недостающие данные либо о выписке рецепта, либо о записи в кабинет в информационные системы и улучшить показатель рейтинга.

## Решение

В качестве предложенного решения проблемы - автоматизировать выгрузку из Единой медицинской информационно-аналитической системы Московской области (ЕМИАС МО), в которой ведут приём в кабинетах выписки льготных лекарственных препаратов, а так же из Единой региональной информационной системы льготного лекарственного обеспечения населения Московской области (ЕРИС ЛЛО) модуля "Корнет" (Корнет), где врачи оформляют электронные и бумажные рецепты. Эти два списка следует сделать в разбивке по подразделениям за определенный период, а затем произвести анализ и выявить людей, которым оформлен рецепт, но не произведена запись в кабинет выписки лекарственных препаратов.

## Методология

В качестве источника данных в ЕМИАС был выбран отчёт **"Отчет по записи на прием_V2"** в системных отчётах, который необходимо выгрузить 9 раз по числу кабинетов подразделениях учреждения. Из Корнета отчёт **"Реестр выписанных рецептов по ДЛО"**, который необходимо выгрузить 26 раз, по числу взрослых поликлинических отделений, у каждого из которых свой индивидуальный логин и пароль для входа в систему. Затем отчёты по каждой из систем объединяются, проводится их очистка, трансформация и анализ, результаты которого сохраняются в файл таблицы Excel.

Для реализации был использован язык программирования Python. Автоматизация открытия и выгрузки отчётов производилась с помощью дополнительной библиотеки Selenium, объединение и анализ данных с помощью Pandas.

Дополнительно использован формат JSON для хранения и обработки учётных данных для авторизации, а также loguru для ведения и сохранения логов.